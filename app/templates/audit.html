{% extends "base.html" %}
{% block title %}Audit | {{ app_name }}{% endblock %}
{% block page_title %}Audit{% endblock %}
{% block page_subtitle %}Trace operational actions and agent runs with readable summaries and payload inspection.{% endblock %}
{% block content %}
<section class="panel">
  <h2>Audit Events</h2>
  <div class="table-wrap">
    <table>
      <thead>
        <tr><th>Time</th><th>Action</th><th>Entity</th><th>Summary</th><th>Payload</th></tr>
      </thead>
      <tbody>
      {% for event in events %}
        <tr>
          <td class="mono">{{ event.created_at }}</td>
          <td><span class="badge status-neutral">{{ event.action }}</span></td>
          <td class="mono">{{ event.entity_type }}:{{ event.entity_id }}</td>
          <td>
            <span class="pill {% if event.action == 'agent_ran' %}pill-agent{% endif %}">
              {{ event.payload_summary }}
            </span>
          </td>
          <td>
            <details>
              <summary>View JSON</summary>
              <pre class="code-block">{{ event.payload | tojson(indent=2) }}</pre>
            </details>
          </td>
        </tr>
      {% else %}
        <tr><td colspan="5" class="muted">No events</td></tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</section>
{% endblock %}
